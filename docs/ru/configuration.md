# Intlayer Конфигурационная Документация

## Обзор

Конфигурационные файлы Intlayer позволяют настраивать различные аспекты плагина, такие как интернационализация, промежуточное ПО и обработка контента. Этот документ предоставляет подробное описание каждого свойства в конфигурации.

---

## Поддержка конфигурационных файлов

Intlayer принимает форматы конфигурационных файлов JSON, JS, MJS и TS:

- `intlayer.config.ts`
- `intlayer.config.js`
- `intlayer.config.json`
- `intlayer.config.cjs`
- `intlayer.config.mjs`
- `.intlayerrc`

---

## Пример конфигурационного файла

```typescript fileName="intlayer.config.ts" codeFormat="typescript"
import { Locales, type IntlayerConfig } from "intlayer";

const config: IntlayerConfig = {
  internationalization: {
    locales: [Locales.ENGLISH],
  },
  content: {
    typesDir: "content/types",
  },
  middleware: {
    noPrefix: false,
  },
};

export default config;
```

```javascript fileName="intlayer.config.cjs" codeFormat="commonjs"
const { Locales } = require("intlayer");

/** @type {import('intlayer').IntlayerConfig} */
const config = {
  internationalization: {
    locales: [Locales.ENGLISH],
  },
  content: {
    typesDir: "content/types",
  },
  middleware: {
    noPrefix: false,
  },
};

module.exports = config;
```

```json5 fileName=".intlayerrc" codeFormat="json"
{
  "internationalization": {
    "locales": ["en"],
  },
  "content": {
    "typesDir": "content/types",
  },
  "middleware": {
    "noPrefix": false,
  },
}
```

---

## Справочник по конфигурации

Следующие разделы описывают различные настройки конфигурации, доступные для Intlayer.

---

### Конфигурация интернационализации

Определяет настройки, связанные с интернационализацией, включая доступные локали и локаль по умолчанию для приложения.

#### Свойства

- **locales**:

  - _Тип_: `string[]`
  - _По умолчанию_: `['en']`
  - _Описание_: Список поддерживаемых локалей в приложении.
  - _Пример_: `['en', 'fr', 'es']`

- **requiredLocales**:
  - _Тип_: `string[]`
  - _По умолчанию_: `[]`
  - _Описание_: Список обязательных локалей в приложении.
  - _Пример_: `[]`
  - _Примечание_: Если пусто, все локали обязательны в режиме `strict`.
  - _Примечание_: Убедитесь, что обязательные локали также определены в поле `locales`.
- **strictMode**:

  - _Тип_: `string`
  - _По умолчанию_: `inclusive`
  - _Описание_: Обеспечивает строгую реализацию интернационализированного контента с использованием TypeScript.
  - _Примечание_: Если установлено значение "strict", функция перевода `t` потребует, чтобы каждая объявленная локаль была определена. Если одна локаль отсутствует или локаль не объявлена в вашей конфигурации, будет выброшена ошибка.
  - _Примечание_: Если установлено значение "inclusive", функция перевода `t` потребует, чтобы каждая объявленная локаль была определена. Если одна локаль отсутствует, будет выдано предупреждение. Но будет принято, если локаль не объявлена в вашей конфигурации, но существует.
  - _Примечание_: Если установлено значение "loose", функция перевода `t` примет любую существующую локаль.

- **defaultLocale**:
  - _Тип_: `string`
  - _По умолчанию_: `'en'`
  - _Описание_: Локаль по умолчанию, используемая в качестве резервной, если запрашиваемая локаль не найдена.
  - _Пример_: `'en'`
  - _Примечание_: Используется для определения локали, если она не указана в URL, cookie или заголовке.

---

### Конфигурация редактора

Определяет настройки, связанные с интегрированным редактором, включая порт сервера и активный статус.

#### Свойства

- **applicationURL**:

  - _Тип_: `string`
  - _По умолчанию_: `'*'`
  - _Описание_: URL приложения. Используется для ограничения происхождения редактора в целях безопасности.
  - _Пример_:
    - `'*'`
    - `'http://localhost:3000'`
    - `'https://example.com'`
    - `process.env.INTLAYER_EDITOR_URL`
  - _Примечание_: URL приложения. Используется для ограничения происхождения редактора в целях безопасности. Если установлено значение `'*'`, редактор доступен с любого происхождения.

- **port**:

  - _Тип_: `number`
  - _По умолчанию_: `8000`
  - _Описание_: Порт, используемый сервером визуального редактора.

- **editorURL**:

  - _Тип_: `string`
  - _По умолчанию_: `'http://localhost:8000'`
  - _Описание_: URL сервера редактора. Используется для ограничения происхождения редактора в целях безопасности.
    - `'http://localhost:3000'`
    - `'https://example.com'`
    - `process.env.INTLAYER_EDITOR_URL`
    - `''*'`
  - _Примечание_: URL сервера редактора для доступа из приложения. Используется для ограничения происхождений, которые могут взаимодействовать с приложением в целях безопасности. Если установлено значение `'*'`, редактор доступен с любого происхождения. Должен быть установлен, если порт изменен или если редактор размещен на другом домене.

- **cmsURL**:

  - _Тип_: `string`
  - _По умолчанию_: `'https://intlayer.org'`
  - _Описание_: URL CMS Intlayer.
  - _Пример_: `'https://intlayer.org'`
  - _Примечание_: URL CMS Intlayer.

- **backendURL**:

  - _Тип_: `string`
  - _По умолчанию_: `https://back.intlayer.org`
  - _Описание_: URL сервера бэкенда.
  - _Пример_: `http://localhost:4000`

- **enabled**:

  - _Тип_: `boolean`
  - _По умолчанию_: `true`
  - _Описание_: Указывает, взаимодействует ли приложение с визуальным редактором.
  - _Пример_: `process.env.NODE_ENV !== 'production'`
  - _Примечание_: Если true, редактор сможет взаимодействовать с приложением. Если false, редактор не сможет взаимодействовать с приложением. В любом случае редактор может быть включен только визуальным редактором. Отключение редактора для определенных сред — это способ усилить безопасность.

- **clientId**:

  - _Тип_: `string` | `undefined`
  - _По умолчанию_: `undefined`
  - _Описание_: clientId и clientSecret позволяют пакетам Intlayer аутентифицироваться с бэкендом, используя аутентификацию oAuth2. Токен доступа используется для аутентификации пользователя, связанного с проектом. Чтобы получить токен доступа, перейдите на https://intlayer.org/dashboard/project и создайте учетную запись.
  - _Пример_: `true`
  - _Примечание_: Важно: clientId и clientSecret должны храниться в секрете и не должны быть общедоступными. Убедитесь, что они хранятся в безопасном месте, например, в переменных окружения.

- **clientSecret**:

  - _Тип_: `string` | `undefined`
  - _По умолчанию_: `undefined`
  - _Описание_: clientId и clientSecret позволяют пакетам Intlayer аутентифицироваться с бэкендом, используя аутентификацию oAuth2. Токен доступа используется для аутентификации пользователя, связанного с проектом. Чтобы получить токен доступа, перейдите на https://intlayer.org/dashboard/project и создайте учетную запись.
  - _Пример_: `true`
  - _Примечание_: Важно: clientId и clientSecret должны храниться в секрете и не должны быть общедоступными. Убедитесь, что они хранятся в безопасном месте, например, в переменных окружения.

- **hotReload**:

  - _Тип_: `boolean`
  - _По умолчанию_: `false`
  - _Описание_: Указывает, должно ли приложение автоматически перезагружать конфигурации локалей при обнаружении изменений.
  - _Пример_: `true`
  - _Примечание_: Например, когда добавляется или обновляется новый словарь, приложение обновит контент для отображения на странице.
  - _Примечание_: Поскольку горячая перезагрузка требует постоянного соединения с сервером, она доступна только для клиентов плана `enterprise`.

- **dictionaryPriorityStrategy**:
  - _Тип_: `string`
  - _По умолчанию_: `'local_first'`
  - _Описание_: Стратегия приоритизации словарей в случае наличия как локальных, так и удаленных словарей. Если установлено значение `'distant_first'`, приложение будет отдавать приоритет удаленным словарям над локальными. Если установлено значение `'local_first'`, приложение будет отдавать приоритет локальным словарям над удаленными.
  - _Пример_: `'distant_first'`

### Конфигурация промежуточного ПО

Настройки, которые управляют поведением промежуточного ПО, включая то, как приложение обрабатывает cookies, заголовки и префиксы URL для управления локалями.

#### Свойства

- **headerName**:
  - _Тип_: `string`
  - _По умолчанию_: `'x-intlayer-locale'`
  - _Описание_: Имя HTTP-заголовка, используемого для определения локали.
  - _Пример_: `'x-custom-locale'`
  - _Примечание_: Это полезно для определения локали на основе API.
- **cookieName**:
  - _Тип_: `string`
  - _По умолчанию_: `'intlayer-locale'`
  - _Описание_: Имя cookie, используемого для хранения локали.
  - _Пример_: `'custom-locale'`
  - _Примечание_: Используется для сохранения локали между сессиями.
- **prefixDefault**:
  - _Тип_: `boolean`
  - _По умолчанию_: `true`
  - _Описание_: Включать ли локаль по умолчанию в URL.
  - _Пример_: `false`
  - _Примечание_: Если `false`, URL для локали по умолчанию не будут иметь префикса локали.
- **basePath**:
  - _Тип_: `string`
  - _По умолчанию_: `''`
  - _Описание_: Базовый путь для URL приложения.
  - _Пример_: `'/my-app'`
  - _Примечание_: Это влияет на то, как строятся URL для приложения.
- **serverSetCookie**:
  - _Тип_: `string`
  - _По умолчанию_: `'always'`
  - _Описание_: Правило для установки cookie локали на сервере.
  - _Опции_: `'always'`, `'never'`
  - _Пример_: `'never'`
  - _Примечание_: Управляет тем, устанавливается ли cookie локали при каждом запросе или никогда.
- **noPrefix**:
  - _Тип_: `boolean`
  - _По умолчанию_: `false`
  - _Описание_: Указывать ли префикс локали в URL.
  - _Пример_: `true`
  - _Примечание_: Если `true`, URL не будут содержать информацию о локали.

---

### Конфигурация контента

Настройки, связанные с обработкой контента в приложении, включая имена директорий, расширения файлов и производные конфигурации.

#### Свойства

- **watch**:
  - _Тип_: `boolean`
  - _По умолчанию_: `process.env.NODE_ENV === 'development'`
  - _Описание_: Указывает, должен ли Intlayer отслеживать изменения в файлах декларации контента в приложении для перестройки связанных словарей.
- **fileExtensions**:
  - _Тип_: `string[]`
  - _По умолчанию_: `['.content.ts', '.content.js', '.content.cjs', '.content.mjs', '.content.json', '.content.tsx', '.content.jsx']`
  - _Описание_: Расширения файлов, которые нужно искать при создании словарей.
  - _Пример_: `['.data.ts', '.data.js', '.data.json']`
  - _Примечание_: Настройка расширений файлов может помочь избежать конфликтов.
- **baseDir**:
  - _Тип_: `string`
  - _По умолчанию_: `process.cwd()`
  - _Описание_: Базовая директория для проекта.
  - _Пример_: `'/path/to/project'`
  - _Примечание_: Используется для разрешения всех связанных с Intlayer директорий.
- **dictionaryOutput**:
  - _Тип_: `string[]`
  - _По умолчанию_: `['intlayer']`
  - _Описание_: Тип вывода словаря, например, `'intlayer'` или `'i18next'`.
- **contentDirName**:
  - _Тип_: `string`
  - _По умолчанию_: `'src'`
  - _Описание_: Имя директории, где хранится контент.
  - _Пример_: `'data'`, `'content'`, `'locales'`
  - _Примечание_: Если не находится на уровне базовой директории, обновите `contentDir`.
- **contentDir**:

  - _Тип_: `string`
  - _Производное от_: `'baseDir'` / `'contentDirName'`
  - _Описание_: Путь к директории, где хранится контент.

- **resultDirName**:
  - _Тип_: `string`
  - _По умолчанию_: `'.intlayer'`
  - _Описание_: Имя директории, где хранятся результаты.
  - _Пример_: `'outputOFIntlayer'`
  - _Примечание_: Если эта директория не находится на базовом уровне, обновите `resultDir`.
- **resultDir**:

  - _Тип_: `string`
  - _Производное от_: `'baseDir'` / `'resultDirName'`
  - _Описание_: Директория для хранения промежуточных или выходных результатов.

- **moduleAugmentationDirName**:

  - _Тип_: `string`
  - _По умолчанию_: `'types'`
  - _Описание_: Директория для расширения модулей, позволяющая улучшить предложения IDE и проверку типов.
  - _Пример_: `'intlayer-types'`
  - _Примечание_: Убедитесь, что эта директория включена в `tsconfig.json`.

- **moduleAugmentationDir**:

  - _Тип_: `string`
  - _Производное от_: `'baseDir'` / `'moduleAugmentationDirName'`
  - _Описание_: Путь для расширения модулей и дополнительных определений типов.

- **dictionariesDirName**:
  - _Тип_: `string`
  - _По умолчанию_: `'dictionary'`
  - _Описание_: Директория для хранения словарей.
  - _Пример_: `'translations'`
  - _Примечание_: Если не находится на уровне директории результатов, обновите `dictionariesDir`.
- **dictionariesDir**:

  - _Тип_: `string`
  - _Производное от_: `'resultDir'` / `'dictionariesDirName'`
  - _Описание_: Директория для хранения словарей локализации.

- **i18nextResourcesDirName**:
  - _Тип_: `string`
  - _По умолчанию_: `'i18next_dictionary'`
  - _Описание_: Директория для хранения словарей i18n.
  - _Пример_: `'translations'`
  - _Примечание_: Если не находится на уровне директории результатов, обновите `i18nextResourcesDir`.
  - _Примечание_: Убедитесь, что вывод словарей i18n включает i18next для создания словарей для i18next.
- **i18nextResourcesDir**:

  - _Тип_: `string`
  - _Производное от_: `'resultDir'` / `'i18nextResourcesDirName'`
  - _Описание_: Директория для хранения словарей i18n.
  - _Примечание_: Убедитесь, что эта директория настроена для типа вывода i18next.

- **typeDirName**:

  - _Тип_: `string`
  - _По умолчанию_: `'types'`
  - _Описание_: Директория для хранения типов словарей.
  - _Пример_: `'intlayer-types'`
  - _Примечание_: Если не находится на уровне директории результатов, обновите `typesDir`.

- **typesDir**:

  - _Тип_: `string`
  - _Производное от_: `'resultDir'` / `'typeDirName'`
  - _Описание_: Директория для хранения типов словарей.

- **mainDirName**:
  - _Тип_: `string`
  - _По умолчанию_: `'main'`
  - _Описание_: Директория для хранения основных файлов.
  - _Пример_: `'intlayer-main'`
  - _Примечание_: Если не находится на уровне директории результатов, обновите `mainDir`.
- **mainDir**:
  - _Тип_: `string`
  - _Производное от_: `'resultDir'` / `'mainDirName'`
  - _Описание_: Директория, где хранятся основные файлы приложения.
- **excludedPath**:
  - _Тип_: `string[]`
  - _По умолчанию_: `['node_modules']`
  - _Описание_: Директории, исключенные из поиска контента.
  - _Примечание_: Эта настройка пока не используется, но планируется для будущей реализации.

### Конфигурация логгера

Настройки, которые управляют логгером, включая используемый префикс.

#### Свойства

- **mode**:
  - _Тип_: `string`
  - _По умолчанию_: `default`
  - _Описание_: Указывает режим работы логгера.
  - _Опции_: `default`, `verbose`, `disabled`
  - _Пример_: `default`
  - _Примечание_: Режим логгера. Режим verbose будет логировать больше информации, но может быть использован для отладки. Режим disabled отключит логгер.
- **prefix**:
  - _Тип_: `string`
  - _По умолчанию_: `'[intlayer] '`
  - _Описание_: Префикс логгера.
  - _Пример_: `'[my custom prefix] '`
  - _Примечание_: Префикс логгера.
